<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
  <mapper namespace="shopIn.mapper.CartsMapper">
  	<select id="itemExists" resultType="boolean"><!-- 查找方法 -->
  		 select count(*) from carts where user_id=#{usersId} and cellpone_id=#{cellponesId}
  	</select>
  	<update id="incItemAmount"><!-- 更新方法 -->
  		update carts set count=count+#{amount}
		where user_id=#{usersId} and cellpone_id=#{cellponesId}
  	</update>
  	<insert id="createItem"><!-- 插入方法 -->
  		insert into carts values(#{usersId},#{cellponesId},#{amount})
  	</insert>
  	<select id="finCartsItems" resultMap="cartsSeek">
		select 
		       c.user_id user_id,c.cellpone_id cellpone_id ,c.count count,
		       ce.id  cellpones_id,ce.brand cellpones_brand,
		       ce.price cellpones_price ,ce.images cellpones_images
		from carts c
		         inner join users u on u.id=c.user_id
		         left join cellpones ce on ce.id=c.cellpone_id
		where c.user_id=#{usersId}
  	</select>
  	<resultMap type="Carts" id="cartsSeek">	
  		<id column="user_id"/>
  		<id column="cellpone_id"/>
  		<result column="count" property="count"/>
		<association property="cellpones" javaType="Cellpones">
			<id column="cellpones_id"  property="id"/>
			<result column="cellpones_brand" property="brand"/>
			<result column="cellpones_price" property="price"/>
			<result column="cellpones_images" property="images"/>
		</association>
  	</resultMap>
  </mapper>